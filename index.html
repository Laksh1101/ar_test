<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>AR Temple NFT Information</title>
    <meta name="description" content="AR Temple Heritage Information System">
    
    <!-- Import A-Frame and AR.js libraries -->
    <script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    
    <!-- Loading Screen Styles -->
    <style>
        .arjs-loader {
            height: 100%;
            width: 100%;
            position: absolute;
            top: 0;
            left: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .arjs-loader div {
            text-align: center;
            font-size: 1.25em;
            color: white;
        }
        
        /* Additional UI styling */
        .info-panel {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-family: Arial, sans-serif;
            font-size: 12px;
            z-index: 100;
        }
    </style>
</head>

<body style="margin: 0px; overflow: hidden;">
    <!-- Info Panel -->
    <div class="info-panel">
        <div>üïâÔ∏è AR Temple Information</div>
        <div>Point camera at temple image</div>
    </div>

    <!-- Minimal Loader Description until the assets are loaded -->
    <div class="arjs-loader">
        <div>Loading AR Temple Info, please wait...</div>
    </div>

    <!-- A-Frame Scene -->
    <a-scene
        vr-mode-ui="enabled: false;"
        renderer="logarithmicDepthBuffer: true;"
        embedded
        arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
        id="scene">

        <!-- The NFT image used for Tracking -->
        <a-nft
            type="nft"
            url="./nft/Dravid_0051"
            smooth="true"
            smoothCount="10"
            smoothTolerance=".01"
            smoothThreshold="5"
            id="temple-nft">

            <!-- Temple Information Card (replacing 3D model) -->
            <a-plane
                position="0 0 0"
                rotation="-90 0 0"
                width="4"
                height="3"
                material="color: #1a1a1a; transparent: true; opacity: 0.95"
                text="value: üïâÔ∏è HERITAGE INFORMATION üïâÔ∏è\n\nBrihadeeswarar Temple\nChola Dynasty - 11th Century CE\nDravidian Architecture Style\nThanjavur, Tamil Nadu\n\nUNESCO World Heritage Site\nBuilt by Raja Raja Chola I\nVimana Height: 66 meters\n\nArchitectural Features:\n‚Ä¢ Massive stone construction\n‚Ä¢ Intricate sculptural work\n‚Ä¢ Perfect geometric proportions; 
                      color: #FFD700; 
                      align: center; 
                      width: 10; 
                      wrapCount: 40;
                      baseline: center"
                animation="property: rotation; from: -90 0 0; to: -90 360 0; loop: true; dur: 30000">
            </a-plane>

            <!-- Decorative Golden Border -->
            <a-plane
                position="0 0 -0.01"
                rotation="-90 0 0"
                width="4.2"
                height="3.2"
                material="color: #FFD700; transparent: true; opacity: 0.4">
            </a-plane>

            <!-- Additional 3D Elements -->
            <a-box
                position="2 0.5 0"
                scale="0.3 0.3 0.3"
                material="color: #8B4513; metalness: 0.2; roughness: 0.8"
                animation="property: rotation; to: 0 360 0; loop: true; dur: 8000">
            </a-box>

            <a-cylinder
                position="-2 0.5 0"
                scale="0.2 0.8 0.2"
                material="color: #FFD700; metalness: 0.8; roughness: 0.2"
                animation="property: position; to: -2 1 0; loop: true; dir: alternate; dur: 2000">
            </a-cylinder>

        </a-nft>

        <!-- Create the Static Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // Debug and event handling
        console.log('AR Temple Information System initializing...');

        // Hide loading screen when AR NFT is loaded
        window.addEventListener('arjs-nft-loaded', function() {
            console.log('NFT marker loaded successfully');
            document.querySelector('.arjs-loader').style.display = 'none';
        });

        // Handle NFT marker detection
        const nftMarker = document.querySelector('#temple-nft');
        
        if (nftMarker) {
            nftMarker.addEventListener('markerFound', function() {
                console.log('üïâÔ∏è Temple image detected! Showing AR information...');
                // Optional: Add sound or additional effects
            });

            nftMarker.addEventListener('markerLost', function() {
                console.log('Temple image lost from view');
            });
        }

        // Camera permission check
        navigator.mediaDevices.getUserMedia({video: true})
            .then(function(stream) {
                console.log('‚úÖ Camera access granted');
            })
            .catch(function(err) {
                console.error('‚ùå Camera access denied:', err);
                alert('Camera access is required for AR functionality');
            });

        // Loading timeout check
        setTimeout(() => {
            const loader = document.querySelector('.arjs-loader');
            if (loader && loader.style.display !== 'none') {
                console.log('‚ö†Ô∏è Still loading... Please check:');
                console.log('1. NFT files are in ./nft/ folder');
                console.log('2. Internet connection is stable');
                console.log('3. Camera permissions are granted');
            }
        }, 15000);

        // Additional error handling
        window.addEventListener('error', function(e) {
            console.error('Application error:', e.error);
        });
    </script>
</body>
</html>
